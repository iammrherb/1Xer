! Cisco IOS 802.1X with MAB Configuration Template
! Generated by Dot1Xer Supreme
! Description: Standard configuration for 802.1X with MAB fallback

! Global AAA Configuration
aaa new-model
aaa authentication dot1x default group RADIUS-SERVERS
aaa authorization network default group RADIUS-SERVERS
aaa accounting dot1x default start-stop group RADIUS-SERVERS

! RADIUS Server Configuration
radius server PRIMARY
 address ipv4 <RADIUS_IP_PRIMARY> auth-port 1812 acct-port 1813
 key <RADIUS_KEY_PRIMARY>
 timeout 5
 retransmit 3

! Backup RADIUS Server Configuration (if specified)
radius server BACKUP
 address ipv4 <RADIUS_IP_SECONDARY> auth-port 1812 acct-port 1813
 key <RADIUS_KEY_SECONDARY>
 timeout 5
 retransmit 3

! RADIUS Server Group
aaa group server radius RADIUS-SERVERS
 server name PRIMARY
 server name BACKUP
 deadtime 15

! Enable 802.1X System-wide
dot1x system-auth-control

! Change of Authorization (CoA) Configuration
aaa server radius dynamic-author
 client <RADIUS_IP_PRIMARY> server-key <RADIUS_KEY_PRIMARY>
 client <RADIUS_IP_SECONDARY> server-key <RADIUS_KEY_SECONDARY>
 auth-type any
 port 3799

! VLAN Configuration
vlan <DATA_VLAN>
 name DATA_VLAN
vlan <VOICE_VLAN>
 name VOICE_VLAN
vlan <GUEST_VLAN>
 name GUEST_VLAN
vlan <CRITICAL_VLAN>
 name CRITICAL_VLAN

! Interface Configuration
interface <INTERFACE>
 description 802.1X + MAB Authentication Port
 switchport mode access
 switchport access vlan <DATA_VLAN>
 switchport voice vlan <VOICE_VLAN>
 switchport nonegotiate
 
 ! Authentication settings
 authentication host-mode multi-auth
 authentication open
 authentication order dot1x mab
 authentication priority dot1x mab
 authentication port-control auto
 authentication periodic
 authentication timer reauthenticate 7200
 authentication timer restart 10
 authentication violation restrict
 
 ! 802.1X configuration
 dot1x pae authenticator
 dot1x timeout tx-period 10
 dot1x max-reauth-req 3
 
 ! MAB configuration
 mab
 
 ! Guest VLAN for authentication failures
 authentication event fail action authorize vlan <GUEST_VLAN>
 
 ! Critical VLAN for RADIUS server unavailability
 authentication event server dead action authorize vlan <CRITICAL_VLAN>
 authentication event server alive action reinitialize
 
 ! Spanning tree configuration
 spanning-tree portfast
 spanning-tree bpduguard enable

! End of Configuration
