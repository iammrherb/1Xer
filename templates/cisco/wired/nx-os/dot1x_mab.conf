! Cisco NX-OS 802.1X with MAB Configuration Template
! Generated by Dot1Xer Supreme
! Description: Configuration for 802.1X with MAB fallback on Nexus switches

! Enable required features
feature dot1x
feature radius
feature aaa

! Configure RADIUS server
radius-server host <RADIUS_IP_PRIMARY> key <RADIUS_KEY_PRIMARY> auth-port 1812 acct-port 1813
radius-server host <RADIUS_IP_SECONDARY> key <RADIUS_KEY_SECONDARY> auth-port 1812 acct-port 1813
radius-server timeout 5
radius-server retransmit 3
radius-server deadtime 15

! Configure AAA settings
aaa authentication dot1x default group radius
aaa accounting dot1x default group radius

! Configure dot1x settings
dot1x system-auth-control

! Change of Authorization (CoA) Configuration
aaa server radius dynamic-author
 client <RADIUS_IP_PRIMARY> server-key <RADIUS_KEY_PRIMARY>
 client <RADIUS_IP_SECONDARY> server-key <RADIUS_KEY_SECONDARY>
 auth-type any
 port 3799

! VLAN Configuration
vlan <DATA_VLAN>
 name DATA_VLAN
vlan <VOICE_VLAN>
 name VOICE_VLAN
vlan <GUEST_VLAN>
 name GUEST_VLAN
vlan <CRITICAL_VLAN>
 name CRITICAL_VLAN

! Interface Configuration
interface <INTERFACE>
 description 802.1X Authentication Port
 switchport access vlan <DATA_VLAN>
 switchport voice vlan <VOICE_VLAN>
 dot1x pae authenticator
 dot1x timeout quiet-period 10
 dot1x timeout tx-period 10
 dot1x timeout re-authperiod 7200
 dot1x timeout ratelimit-period 0
 dot1x max-req 2
 dot1x max-reauth-req 2
 dot1x host-mode multi-auth
 dot1x port-control auto
 mac-authentication-bypass
 dot1x auth-fail vlan <GUEST_VLAN>
 dot1x critical vlan <CRITICAL_VLAN>
 spanning-tree port type edge
 spanning-tree bpduguard enable

! End of Configuration
